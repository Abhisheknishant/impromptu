#!/usr/bin/env bash

source $IMPROMPTU_BIN/impromptu-utils
impromptu_ensure_constants

# Check for version or help flags.
if [[ -n "$1" ]]; then
  if [[ "$1" == "-v" || "$1" == "--version" ]]; then
    $IMPROMPTU_BIN/impromptu-node-cli $1
  fi

  if [[ "$1" == "-h" || "$1" == "--help" ]]; then
    $IMPROMPTU_BIN/impromptu-node-cli $1
  fi

  if [[ "$1" == "--no-server" ]]; then
    impromptu_set_prompt_command impromptu-node-cli
  fi

  if [[ "$1" == "prompt" ]]; then
    if [[ -n "$2" && "$2" == "--no-server" ]]; then
      $IMPROMPTU_BIN/impromptu-node-cli
    else
      source $IMPROMPTU_BIN/impromptu-client
    fi
  fi

  exit
fi

impromptu_ensure_server
impromptu_set_prompt_command impromptu-client
